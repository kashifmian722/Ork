{% sw_extends '@Storefront/storefront/base.html.twig' %}
{% block base_content %}
    <div class="row justify-content-center">
        <div class="col-xl-9">
            <div class="row">
                <div class="col-lg-12 pt-4 pb-4 card">
                    <form autocomplete="off" action="{{ url('add-appointment') }}" method="post"  class="php-email-form">
                        <input type="hidden" name="_csrf_token"  value="{{ csrf_token('add-appointment') }}">
                        <div class="form-row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="datepicker">Tag</label>
                                    <input id="datepicker" class="form-control datepicker" name="pick_date" data-rule="date" placeholder="Tag auswählen" data-msg="date" required="">
                                    <div class="validate"></div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="row m-0 redio-div" style="padding-top: 2.04rem">
                                    <div class="col">
                                        <div class="form-group">
                                            <input type="radio" checked="" id="spp" value="chekko_app" name="type" style="width: 18px;height: 18px;vertical-align: middle;margin-bottom: 5px">
                                            <label for="spp">CHEKKO-App</label>
                                        </div>
                                    </div>
                                    <div class="col pl-0">
                                        <input type="radio" id="tpp" name="type" value="test_app" style="width: 18px;height: 18px;vertical-align: middle;margin-bottom: 5px">
                                        <label for="tpp">Test ohne App</label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6"></div>
                            <div class="col-md-12 form-group property-types" id="time_slot" style="display: none">
                                <label for="datepickerd" class="w-100">Uhrzeit</label>

                                <div class="row m-0" id="time_slots_box">

                                </div>
                            </div>
                        </div>
                        <div id="register_box">
                            <div class="form-row">
                                <div class="col-md-6  form-group">
                                    <label for="namer1"> Vorname </label>
                                    <input type="text" name="first_name" class="form-control" id="namer1" data-rule="minlen:4" value="" maxlength="100" placeholder="Vorname" required="" data-msg="Please enter at least 4 chars">
                                    <div class="validate"></div>
                                </div>
                                <div class="col-md-6  form-group">
                                    <label for="namer"> Name </label>
                                    <input type="text" name="name" class="form-control" id="namer" data-rule="minlen:4" value="" maxlength="100" placeholder="Name" required="" data-msg="Please enter at least 4 chars">
                                    <div class="validate"></div>
                                </div>





                                <div class="col-md-6 form-group">
                                    <label for="emailw">Ihre Emailadresse</label>
                                    <input type="email" class="form-control" name="email" id="emailw" data-rule="email" placeholder="Ihre Emailadresse" value="" data-msg="Please enter a valid email" required="">
                                    <div class="validate"></div>
                                </div>
                                <div class="col-md-6 form-group">
                                    <label for="named">Telefonnummer </label>
                                    <input type="tel" name="phone" class="form-control" id="named" data-rule="minlen:6" maxlength="12" value="" placeholder="Telefonnummer" data-msg="phone" required="">
                                    <div class="validate"></div>
                                </div>
                                <div class="col-md-12" id="extra_fields" style="display: none">
                                    <div class="row">
                                        <div class="col-6 form-group pr-1">
                                            <label for="zip1"> PLZ </label>
                                            <input type="tel" name="zip" class="form-control" id="zip1" data-rule="minlen:6" maxlength="15" placeholder="PlZ" data-msg="zip">
                                            <div class="validate"></div>
                                        </div>
                                        <div class="col-6 form-group pl-1">
                                            <label for="Ort2"> Ort </label>
                                            <input type="text" name="city" class="form-control" id="Ort2" data-rule="minlen:6" maxlength="25" placeholder="Ort" data-msg="Ort">
                                            <div class="validate"></div>
                                        </div>
                                        <div class="col-md-12 mb-3">
                                            <label for="Ort"> Straße </label>
                                            <input type="text" name="street" class="form-control" id="Ort" data-rule="minlen:6" maxlength="290" placeholder="Straße" data-msg="Straße">
                                            <div class="validate"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 text-white">
                                    <p class="text-primary">
                                        <label class="pr-1 mb-0" for="info">
                                            <input type="checkbox" required="" id="info" style="width: 16px;height: 16px;vertical-align: middle;   margin-bottom: 4px;">
                                        </label>
                                        Ich habe die Datenschutzerklärung zur Kenntnis genommen und stimme zu, dass meine Angaben und Daten zur Beantwortung meiner Anfrage elektronisch erhoben und gespeichert werden.
                                    </p>
                                </div>
                                <div class="col-md-12">
                                    <div class="text-right">
                                        <button class="mt-3 btn-primary btn border-primary bg-primary btn-submit" type="submit">
                                            Senden
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>


            </div>
        </div>
    </div>
    <script src="https://testzentrum-buer.de/assets/vendor/jquery/jquery.min.js"></script>




    <!-- Template Main JS File -->

    <script src="https://testzentrum-buer.de/assets/vendors/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>
    <script>
        !function(a){a.fn.datepicker.dates.de={days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],daysShort:["Son","Mon","Die","Mit","Don","Fre","Sam"],daysMin:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthsShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],today:"Heute",monthsTitle:"Monate",clear:"Löschen",weekStart:1,format:"dd.mm.yyyy"}}(jQuery);
    </script>
    <script>
        $.ajaxSetup({
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            }
        });

        let off_days = [];
        off_days = off_days.map(day => day === 7 ? 0 : day)
        let d = new Date();
        d.setDate(d.getDate());
        $('#datepicker').datepicker({
            autoclose: true,
            locale: 'de',
            language: 'de',
            daysOfWeekDisabled: off_days,
            startDate: d
        });

        $('input[name="pick_date"]').change(function (){
            getTimeSlots($(this).val());
        });


        function getTimeSlots(val){
            let url = 'https://testzentrum-buer.de/user/get-available-timeslots'
            $.post(url , { date: val } ,function (response){
                $('#time_slots_box').html(response);
                $('#time_slot').show();
            });
        }

        $(document).on('change','input[name="type"]',function (){
            if ($(this).val() === "chekko_app"){
                $('#extra_fields').hide();
                $('#extra_fields input').prop('required',false);
            }
            else{
                $('#extra_fields').show();
                $('#extra_fields input').prop('required',true);
            }
        });
    </script>

{% endblock %}
